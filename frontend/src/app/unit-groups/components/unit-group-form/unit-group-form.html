<h2><strong>Formulaire pour groupe de lot</strong></h2>
<hr>

<form [formGroup]="unitGroupForm" (ngSubmit)="onSubmit()">
  <div>
    <label>Nom: </label>
    <input formControlName="name" placeholder="Nom du groupe" />
    <div *ngIf="unitGroupForm.get('name')?.invalid && unitGroupForm.get('name')?.touched">
      <small *ngIf="unitGroupForm.get('name')?.errors?.['required']">* Ce champ ne peut pas être vide.</small>
      <small *ngIf="unitGroupForm.get('name')?.errors?.['minlength']">* Ce champ doit contenir au moins 2 caractères.</small>
      <small *ngIf="unitGroupForm.get('name')?.errors?.['maxlength']">* Ce champ ne peut contenir plus que 50 caractères.</small>
    </div>
  </div>

  <div>
    <label>Description: </label>
    <textarea 
      formControlName="description" 
      placeholder="Donnez ici un peu plus de détails sur le contenu du groupe (champ non obligatoire)." 
      style="width: 100%; min-height: 20px; overflow:hidden;"
      #description
      (input)="description.style.height = 'auto'; description.style.height = description.scrollHeight + 'px';"
    ></textarea>
  </div>

  <div>
    <label for="special_shares">Tantième spécifique? : </label>
    <select id="special_shares" formControlName="special_shares">
      <option value="false">Non</option>
      <option value="true">Oui</option>
    </select>
    
  </div>



  <div *ngFor="let unit of units">
    <label>
      <input
        type="checkbox"
        [value]="unit.id"
        [checked]="selectedUnitsIdsOnly.includes(unit.id)"
        (change)="onCheckboxChange(unit.id, $event)"
      />
      {{ unit.name }}
    </label>
  
    <span *ngIf="unitGroupForm.get('special_shares')?.value == 'true'">
      <label [for]="'adj_shares-' + unit.id">Millièmes ajustées</label>
      <input 
        type="text"
        name="adj_shares"
        [id]="'adj_shares-' + unit.id"
        [value]="getShareValue(unit.id)"
      />
    </span>
  </div>
  
<!--

  <div>
    <div>Lots: </div>

    <div *ngFor="let unit of units">
      <label>
        <input
          type="checkbox"
          [value]="unit.id"
          [checked]="selectedUnitsIdsOnly.includes(unit.id)"
          (change)="onCheckboxChange(unit.id,$event)"
          />
        {{ unit.name }}        
        <span *ngIf="unitGroupForm.get('special_shares')?.value == '1'">
          <label for='adj_shares'> Millièmes ajustées </label>
          <input 
            type= 'text' 
            name='adj_shares' 
            [id]="'adj_shares-' + unit.id"
            [value]="getShareValue(unit.id)"
          />  
        </span>
        </label>
    </div>
  </div>

  -->

  <button type="submit" [disabled]="unitGroupForm.invalid" class="whitespace-nowrap flex-1 text-black hover:text-indigo-600 bg-zinc-100 px-3 py-2 rounded-md text-sm font-medium text-center m-4">
    {{ isEditMode ? 'Mettre à jour' : 'Créer' }} le groupe
  </button> <br>
</form>
